
<!DOCTYPE HTML>
<html lang="ja" >
    <head>
        <meta charset="UTF-8">
        <title>手順 · タイトル</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.4">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-intopic-toc/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-multipart/multipart.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="B_02.html" />
    
    
    <link rel="prev" href="B_00.md" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="検索ワードを入力" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    演習A
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../Training_A/A_00.html">
            
                <a href="../Training_A/A_00.html">
            
                    
                    イントロ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../Training_A/A_01.html">
            
                <a href="../Training_A/A_01.html">
            
                    
                    手順
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../Training_A/A_02.html">
            
                <a href="../Training_A/A_02.html">
            
                    
                    課題
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    演習B
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="B_00.md">
            
                <span>
            
                    
                    イントロ
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2" data-path="B_01.html">
            
                <a href="B_01.html">
            
                    
                    手順
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="B_02.html">
            
                <a href="B_02.html">
            
                    
                    課題
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    演習C
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../Training_C/C_00.html">
            
                <a href="../Training_C/C_00.html">
            
                    
                    イントロ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../Training_C/C_01.html">
            
                <a href="../Training_C/C_01.html">
            
                    
                    手順
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../Training_C/C_02.html">
            
                <a href="../Training_C/C_02.html">
            
                    
                    課題
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Links</li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <a target="_blank" href="https://manaba.tsukuba.ac.jp/ct/course_2438996">
            
                    
                    manabaのページ
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            HonKitで公開 
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >手順</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <html><head></head><body><h1 id="演習b：手順"><a name="演習b：手順" class="plugin-anchor" href="#演習b：手順"><i class="fa fa-link" aria-hidden="true"></i></a>演習B：手順</h1>
<h2 id="1-データのダウンロード"><a name="1-データのダウンロード" class="plugin-anchor" href="#1-データのダウンロード"><i class="fa fa-link" aria-hidden="true"></i></a>1. データのダウンロード</h2>
<p>Jupyter Hubのターミナルを開き、以下のコマンドを実行してデータをダウンロードしてください。</p>
<pre><code class="lang-bash">mkdir data

<span class="hljs-built_in">cd</span> data

wget https://raw.githubusercontent.com/bioinfo-tsukuba/20201226-EB62104-bioinformatics-course/master/tutorial/data/GSE59831_processed_data_FPKM.txt

wget https://github.com/bioinfo-tsukuba/20201226-EB62104-bioinformatics-course/raw/master/tutorial/data/CCCExplorer/CD11CB_output/gene_exp.diff

wget https://github.com/bioinfo-tsukuba/20201226-EB62104-bioinformatics-course/raw/master/tutorial/data/CCCExplorer/HOM_MouseHumanSequence.rpt

wget https://github.com/bioinfo-tsukuba/20201226-EB62104-bioinformatics-course/raw/master/tutorial/data/CCCExplorer/EP_output/genes.read_group_tracking

wget https://github.com/bioinfo-tsukuba/20201226-EB62104-bioinformatics-course/raw/master/tutorial/data/CCCExplorer/LR_manual_revised.txt

<span class="hljs-built_in">cd</span> ../
</code></pre>
<h2 id="2-tidyverse-について学ぶ"><a name="2-tidyverse-について学ぶ" class="plugin-anchor" href="#2-tidyverse-について学ぶ"><i class="fa fa-link" aria-hidden="true"></i></a>2. <code>tidyverse</code> について学ぶ</h2>
<h3 id="以降は-r-のノートブックを作成して始めましょう"><a name="以降は-r-のノートブックを作成して始めましょう" class="plugin-anchor" href="#以降は-r-のノートブックを作成して始めましょう"><i class="fa fa-link" aria-hidden="true"></i></a>以降は R のノートブックを作成して始めましょう</h3>
<ul>
<li>R のノートブックを新しく作成してください</li>
<li>タイトルを &quot;training_B&quot; に変更してください</li>
</ul>
<h3 id="tidyverse-とは"><a name="tidyverse-とは" class="plugin-anchor" href="#tidyverse-とは"><i class="fa fa-link" aria-hidden="true"></i></a><code>tidyverse</code> とは</h3>
<ul>
<li>データサイエンスに便利なパッケージの集合体</li>
<li>今日の授業で毎回使用します</li>
</ul>
<h3 id="tidyverse-を使うには"><a name="tidyverse-を使うには" class="plugin-anchor" href="#tidyverse-を使うには"><i class="fa fa-link" aria-hidden="true"></i></a>tidyverse を使うには</h3>
<p>そのノートブックの中で一度、以下を実行する必要があります。</p>
<pre><code class="lang-R">library(tidyverse)
</code></pre>
<p>以下のような(感じの）メッセージが出てくると思います（問題ありません）</p>
<pre><code>── [1mAttaching packages[22m ─────────────────────────────────────── tidyverse 1.3.0 ──

[32m✔[39m [34mggplot2[39m 3.3.3     [32m✔[39m [34mpurrr  [39m 0.3.4
[32m✔[39m [34mtibble [39m 3.0.5     [32m✔[39m [34mdplyr  [39m 1.0.3
[32m✔[39m [34mtidyr  [39m 1.1.2     [32m✔[39m [34mstringr[39m 1.4.0
[32m✔[39m [34mreadr  [39m 1.4.0     [32m✔[39m [34mforcats[39m 0.5.1

── [1mConflicts[22m ────────────────────────────────────────── tidyverse_conflicts() ──
[31m✖[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
[31m✖[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()
</code></pre><h3 id="テーブル（表）データの読み込み：-readtsv-readcsv"><a name="テーブル（表）データの読み込み：-readtsv-readcsv" class="plugin-anchor" href="#テーブル（表）データの読み込み：-readtsv-readcsv"><i class="fa fa-link" aria-hidden="true"></i></a>テーブル（表）データの読み込み： <code>read_tsv()</code>, <code>read_csv()</code></h3>
<ul>
<li>データの読み込みには <code>read_tsv()</code>, <code>read_csv()</code> を用います</li>
<li>TSV はタブ区切りファイル、CSV はコンマ区切りファイルのことです<ul>
<li>1.でダウンロードしたファイルがTSVかCSVかは、ターミナルで <code>head</code> コマンドで確かめられます</li>
</ul>
</li>
<li>例えば、 <code>GSE59831_processed_data_FPKM.txt</code> はタブ区切りファイルなので、 <code>read_tsv()</code> で読み込むことができます<ul>
<li><code>col_names=TRUE</code> は、１行目を列名として扱ってほしいという意味です。</li>
</ul>
</li>
</ul>
<p>以下のコマンドは、 <code>GSE59831_processed_data_FPKM.txt</code> を読み込み、 <code>df1</code> というオブジェクトに格納することを表します。</p>
<pre><code class="lang-R">df1 &lt;- read_tsv(<span class="hljs-string">&quot;data/GSE59831_processed_data_FPKM.txt&quot;</span>, col_names=<span class="hljs-literal">TRUE</span>)
</code></pre>
<h2 id="データテーブル（表）の形を調べるのに便利な関数：-dim-head-str"><a name="データテーブル（表）の形を調べるのに便利な関数：-dim-head-str" class="plugin-anchor" href="#データテーブル（表）の形を調べるのに便利な関数：-dim-head-str"><i class="fa fa-link" aria-hidden="true"></i></a>データテーブル（表）の形を調べるのに便利な関数： <code>dim()</code>, <code>head()</code>, <code>str()</code></h2>
<ul>
<li><code>head()</code> はデータフレームの最初の6行を表示します</li>
<li><code>dim()</code> はデータフレームの行数と列数を出力します</li>
<li><code>str()</code> は行数と列数のほか、データフレームがどんな列（列名、列のデータ型）を持つかを表示します</li>
<li><code>nrow()</code>、<code>ncol()</code> はそれぞれ行数、列数を出力します</li>
</ul>
<p>以下に実行例を示します。</p>
<pre><code class="lang-R">head(df1)
</code></pre>
<p>こんな結果が返ってきます：</p>
<table class="dataframe">
<caption>A tibble: 6 × 29</caption>
<thead>
    <tr><th scope="col">mice_gene_symbol</th><th scope="col">human_gene_symbol</th><th scope="col">Tum1</th><th scope="col">Tum2</th><th scope="col">Tum3</th><th scope="col">WT1</th><th scope="col">WT2</th><th scope="col">Tum4</th><th scope="col">Tum5</th><th scope="col">WT3</th><th scope="col">⋯</th><th scope="col">Tum11</th><th scope="col">WT8</th><th scope="col">WT9</th><th scope="col">WT10</th><th scope="col">Tum12</th><th scope="col">Tum13</th><th scope="col">Tum14</th><th scope="col">WT11</th><th scope="col">WT12</th><th scope="col">WT13</th></tr>
    <tr><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">⋯</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>0610007P14Rik</td><td>C14orf1 </td><td> 9.31368</td><td>10.13680</td><td>12.26660</td><td>11.92950</td><td>11.34170</td><td>10.45680</td><td>10.44590</td><td>13.05840</td><td>⋯</td><td>21.99580</td><td>33.98430</td><td>23.50140</td><td>24.80460</td><td>17.16570</td><td>12.51170</td><td>16.03630</td><td>14.69160</td><td>14.03290</td><td>14.20440</td></tr>
    <tr><td>0610009D07Rik</td><td>SF3B14  </td><td>25.35280</td><td>32.25990</td><td>26.61000</td><td>29.73440</td><td>37.16520</td><td>37.57330</td><td>30.74340</td><td>32.30680</td><td>⋯</td><td>28.76030</td><td>21.51540</td><td>30.83840</td><td>19.26180</td><td>35.14690</td><td>33.53620</td><td>42.73760</td><td>29.27860</td><td>29.37960</td><td>28.06600</td></tr>
    <tr><td>0610009O20Rik</td><td>KIAA0141</td><td>12.45760</td><td>10.17690</td><td>11.95220</td><td>10.62740</td><td> 7.04763</td><td> 9.63765</td><td>11.11900</td><td>13.35890</td><td>⋯</td><td>20.57930</td><td>18.12230</td><td>18.65090</td><td>18.58170</td><td>15.60410</td><td>15.34920</td><td>13.04400</td><td>16.76130</td><td>15.91300</td><td>18.05510</td></tr>
    <tr><td>0610010F05Rik</td><td>KIAA1841</td><td> 5.84091</td><td> 6.54488</td><td> 6.65366</td><td> 4.80074</td><td> 6.06263</td><td> 5.57042</td><td> 5.21223</td><td> 5.56449</td><td>⋯</td><td> 8.04684</td><td> 5.92199</td><td> 6.23551</td><td> 4.73364</td><td> 5.98708</td><td> 4.26902</td><td> 4.16373</td><td> 3.47511</td><td> 3.71875</td><td> 3.95344</td></tr>
    <tr><td>0610010K14Rik</td><td>C17orf49</td><td>25.63690</td><td>24.08560</td><td>20.17560</td><td>25.34280</td><td>29.14040</td><td>31.46110</td><td>28.30990</td><td>22.17650</td><td>⋯</td><td>18.00200</td><td>24.00260</td><td>21.85860</td><td>23.72630</td><td>28.46520</td><td>31.19330</td><td>26.40880</td><td>32.53430</td><td>26.93620</td><td>29.38080</td></tr>
    <tr><td>0610011F06Rik</td><td>C16orf13</td><td> 3.48174</td><td> 5.79169</td><td> 3.73809</td><td> 5.94575</td><td> 5.98899</td><td> 9.04125</td><td> 5.84235</td><td> 7.36357</td><td>⋯</td><td>42.61460</td><td>38.91730</td><td>33.56900</td><td>37.34490</td><td>20.33750</td><td>18.81900</td><td>14.17990</td><td>14.93870</td><td>16.12340</td><td>13.39220</td></tr>
</tbody>
</table>


<p>今度はこれを実行してみましょう：</p>
<pre><code class="lang-R"><span class="hljs-built_in">dim</span>(df1)
</code></pre>
<p>こんな結果が返ってきます（行数、列数）：</p>
<pre><code>16024   29
</code></pre><p>今度はこれを実行してみましょう：</p>
<pre><code class="lang-R">str(df1)
</code></pre>
<p>[16,024 × 29] は行数と列数を表します。また、 <code>$</code> で始まる行は、各列にどのような値が格納されているかを表します：</p>
<pre><code>tibble [16,024 × 29] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ mice_gene_symbol : chr [1:16024] &quot;0610007P14Rik&quot; &quot;0610009D07Rik&quot; &quot;0610009O20Rik&quot; &quot;0610010F05Rik&quot; ...
 $ human_gene_symbol: chr [1:16024] &quot;C14orf1&quot; &quot;SF3B14&quot; &quot;KIAA0141&quot; &quot;KIAA1841&quot; ...
 $ Tum1             : num [1:16024] 9.31 25.35 12.46 5.84 25.64 ...
 $ Tum2             : num [1:16024] 10.14 32.26 10.18 6.54 24.09 ...
 $ Tum3             : num [1:16024] 12.27 26.61 11.95 6.65 20.18 ...
 $ WT1              : num [1:16024] 11.9 29.7 10.6 4.8 25.3 ...
 $ WT2              : num [1:16024] 11.34 37.17 7.05 6.06 29.14 ...
 $ Tum4             : num [1:16024] 10.46 37.57 9.64 5.57 31.46 ...
 $ Tum5             : num [1:16024] 10.45 30.74 11.12 5.21 28.31 ...
 $ WT3              : num [1:16024] 13.06 32.31 13.36 5.56 22.18 ...
 $ WT4              : num [1:16024] 8.74 25.08 12.65 3.93 28.72 ...
 $ Tum6             : num [1:16024] 3.9 31.15 3.93 1.56 22.08 ...
 $ Tum7             : num [1:16024] 2.54 33.48 3.74 1.68 19.04 ...
 $ Tum8             : num [1:16024] 3.34 36.3 3.67 1.24 18.23 ...
 $ WT5              : num [1:16024] 1.14 26.84 2.88 1.05 6.45 ...
 $ WT6              : num [1:16024] 1.553 24.426 3.984 0.645 11.169 ...
 $ WT7              : num [1:16024] 2.7 22.99 3.74 1.1 8.6 ...
 $ Tum9             : num [1:16024] 21.51 30.39 19.15 7.35 20.08 ...
 $ Tum10            : num [1:16024] 25.08 23.83 20.82 7.22 22.06 ...
 $ Tum11            : num [1:16024] 22 28.76 20.58 8.05 18 ...
 $ WT8              : num [1:16024] 33.98 21.52 18.12 5.92 24 ...
 $ WT9              : num [1:16024] 23.5 30.84 18.65 6.24 21.86 ...
 $ WT10             : num [1:16024] 24.8 19.26 18.58 4.73 23.73 ...
 $ Tum12            : num [1:16024] 17.17 35.15 15.6 5.99 28.47 ...
 $ Tum13            : num [1:16024] 12.51 33.54 15.35 4.27 31.19 ...
 $ Tum14            : num [1:16024] 16.04 42.74 13.04 4.16 26.41 ...
 $ WT11             : num [1:16024] 14.69 29.28 16.76 3.48 32.53 ...
 $ WT12             : num [1:16024] 14.03 29.38 15.91 3.72 26.94 ...
 $ WT13             : num [1:16024] 14.2 28.07 18.06 3.95 29.38 ...
 - attr(*, &quot;spec&quot;)=
  .. cols(
  ..   mice_gene_symbol = [31mcol_character()[39m,
  ..   human_gene_symbol = [31mcol_character()[39m,
  ..   Tum1 = [32mcol_double()[39m,
  ..   Tum2 = [32mcol_double()[39m,
  ..   Tum3 = [32mcol_double()[39m,
  ..   WT1 = [32mcol_double()[39m,
  ..   WT2 = [32mcol_double()[39m,
  ..   Tum4 = [32mcol_double()[39m,
  ..   Tum5 = [32mcol_double()[39m,
  ..   WT3 = [32mcol_double()[39m,
  ..   WT4 = [32mcol_double()[39m,
  ..   Tum6 = [32mcol_double()[39m,
  ..   Tum7 = [32mcol_double()[39m,
  ..   Tum8 = [32mcol_double()[39m,
  ..   WT5 = [32mcol_double()[39m,
  ..   WT6 = [32mcol_double()[39m,
  ..   WT7 = [32mcol_double()[39m,
  ..   Tum9 = [32mcol_double()[39m,
  ..   Tum10 = [32mcol_double()[39m,
  ..   Tum11 = [32mcol_double()[39m,
  ..   WT8 = [32mcol_double()[39m,
  ..   WT9 = [32mcol_double()[39m,
  ..   WT10 = [32mcol_double()[39m,
  ..   Tum12 = [32mcol_double()[39m,
  ..   Tum13 = [32mcol_double()[39m,
  ..   Tum14 = [32mcol_double()[39m,
  ..   WT11 = [32mcol_double()[39m,
  ..   WT12 = [32mcol_double()[39m,
  ..   WT13 = [32mcol_double()[39m
  .. )
</code></pre><h3 id="データフレームから特定の条件に当てはまる行を抽出する：-filter"><a name="データフレームから特定の条件に当てはまる行を抽出する：-filter" class="plugin-anchor" href="#データフレームから特定の条件に当てはまる行を抽出する：-filter"><i class="fa fa-link" aria-hidden="true"></i></a>データフレームから特定の条件に当てはまる行を抽出する： <code>filter()</code></h3>
<ul>
<li><code>filter()</code> は第１引数にデータフレーム、第２引数に条件式を書くと、条件に当てはまる行を抽出する</li>
</ul>
<p>以下に例を示します</p>
<pre><code class="lang-R"><span class="hljs-comment"># Tum1 列の値が100より大きい行を抽出</span>
filter(df1, Tum1 &gt; <span class="hljs-number">100</span>)

<span class="hljs-comment"># Tum1 列の値が100より大きく、WT1 列の値が10より小さい行を抽出</span>
<span class="hljs-comment"># (&amp; は同時に満たすべき条件を組み合わせる)</span>
filter(df1, Tum1 &gt; <span class="hljs-number">100</span> &amp; WT1 &lt;<span class="hljs-number">10</span>)

<span class="hljs-comment"># Tum1 列の値が100より大きいか、Tum1 列の値が100より大きい行を抽出</span>
<span class="hljs-comment"># (| はいずれか満たすべき条件を組み合わせる)</span>
filter(df1, Tum1 &gt; <span class="hljs-number">100</span> | Tum2 &gt; <span class="hljs-number">100</span>)

<span class="hljs-comment"># 「Tum1 列の値が100より大きいか、Tum1 列の値が100より大きい」</span>
<span class="hljs-comment"># かつ「WT1列の値が10より小さいか、WT2列の値が10より小さい」行を抽出</span>
<span class="hljs-comment"># (カッコで囲むことでひとまとまりとして扱える)</span>
filter(df1, (Tum1&gt;<span class="hljs-number">100</span> | Tum2&gt;<span class="hljs-number">100</span>) &amp; (WT1&lt;<span class="hljs-number">10</span> | WT2&lt;<span class="hljs-number">10</span>) )
</code></pre>
<p>なお、抽出された結果は、元のデータフレーム自体には保存されないため、別のオブジェクトに格納する必要がある</p>
<pre><code class="lang-R">df1_sub &lt;- filter(df1, Tum1 &gt; 100)

# 上と同じ意味
filter(df1, Tum1 &gt; 100) -&gt; df1_sub
</code></pre>
<h3 id="特定の列を抽出する：-select"><a name="特定の列を抽出する：-select" class="plugin-anchor" href="#特定の列を抽出する：-select"><i class="fa fa-link" aria-hidden="true"></i></a>特定の列を抽出する： <code>select()</code></h3>
<ul>
<li><code>select()</code> は第１引数にデータフレーム、第２（以降）引数に列名を書くと、条件に当てはまる列を抽出する<ul>
<li>列名にスペースが入っている場合はバックスラッシュ（ ` ）で囲む必要がある</li>
</ul>
</li>
</ul>
<p>以下に例を示す</p>
<pre><code class="lang-R"><span class="hljs-comment"># mice_gene_symbol 列を抽出する</span>
select(df1, mice_gene_symbol)

<span class="hljs-comment"># mice_gene_symbol 列とWT1列を抽出する</span>
select(df1, mice_gene_symbol, WT1)

<span class="hljs-comment"># mice_gene_symbol 列を抽出する</span>
select(df1, mice_gene_symbol, human_gene_symbol, WT1)

<span class="hljs-comment"># mice_gene_symbol 列以外を抽出する</span>
<span class="hljs-comment"># (-を前につけるとその列を除く)</span>
select(df1, -mice_gene_symbol)
</code></pre>
<p>なお、抽出された結果は、元のデータフレーム自体には保存されないため、別のオブジェクトに格納する必要がある</p>
<pre><code class="lang-R">df1_selected &lt;- select(df1, mice_gene_symbol, WT1)

# 上と同じ意味
select(df1, mice_gene_symbol, WT1) -&gt; df1_selected
</code></pre>
<h3 id="パイプ演算子-"><a name="パイプ演算子-" class="plugin-anchor" href="#パイプ演算子-"><i class="fa fa-link" aria-hidden="true"></i></a>パイプ演算子 <code>%&gt;%</code></h3>
<ul>
<li><code>%&gt;%</code> → これのこと</li>
<li><code>tidyverse</code> パッケージで使用できる</li>
</ul>
<p>以下に例を示す</p>
<pre><code class="lang-R"><span class="hljs-comment"># str(df1) と同じ</span>
df1 %&gt;% str
</code></pre>
<pre><code class="lang-R"><span class="hljs-comment"># select(df1, mice_gene_symbol, WT1) と同じ</span>
df1 %&gt;% select(mice_gene_symbol, WT1)

<span class="hljs-comment"># %&gt;% の後に改行やインデントが入っても同じ意味</span>
df1 %&gt;% 
    select(mice_gene_symbol, WT1)
</code></pre>
<pre><code class="lang-R"># select(filter(df1, Tum1&gt;100), WT) と同じ意味
# (パイプをつなげることもできる)
df1 %&gt;% 
    filter(Tum1&gt;100) %&gt;%
    select(mice_gene_symbol, WT1)

# 結果を格納することもできる
df1 %&gt;% 
    filter(Tum1&gt;100) %&gt;%
    select(mice_gene_symbol, WT1) -&gt; df1_filtered_selected
</code></pre>
<h3 id="列を加える：-mutate"><a name="列を加える：-mutate" class="plugin-anchor" href="#列を加える：-mutate"><i class="fa fa-link" aria-hidden="true"></i></a>列を加える： <code>mutate()</code></h3>
<ul>
<li><code>mutate()</code> は新しい列を加えることができる<ul>
<li>第２引数では、<code>=</code> の前に新しい列名を書き、<code>=</code> の後に条件を書く</li>
</ul>
</li>
</ul>
<pre><code class="lang-R">mutate(df1, Tum123_mean = (Tum1+Tum2+Tum3)/<span class="hljs-number">3</span>)

<span class="hljs-comment"># 上と同じ</span>
df1 %&gt;% mutate(Tum123_mean = (Tum1+Tum2+Tum3)/<span class="hljs-number">3</span>)
</code></pre>
<pre><code class="lang-R"><span class="hljs-comment"># 同時に複数も可能</span>
mutate(df1, Tum123_mean = (Tum1+Tum2+Tum3)/<span class="hljs-number">3</span>, WT12_mean = (WT1+WT2)/<span class="hljs-number">2</span>)

<span class="hljs-comment"># 上と同じ</span>
df1 %&gt;% mutate(Tum123_mean = (Tum1+Tum2+Tum3)/<span class="hljs-number">3</span>, WT12_mean = (WT1+WT2)/<span class="hljs-number">2</span>)
</code></pre>
<h3 id="２つの列を結合する"><a name="２つの列を結合する" class="plugin-anchor" href="#２つの列を結合する"><i class="fa fa-link" aria-hidden="true"></i></a>２つの列を結合する</h3>
<ul>
<li>２つの列を結合する操作を一般に JOIN (じょいん)と呼ぶ</li>
<li>２つの表を結合するための列をキー（key）と呼ぶ</li>
</ul>
<p><img src="img/2021-02-07-00-39-59.png" alt></p>
<p><img src="img/2021-02-07-00-40-45.png" alt></p>
<pre><code class="lang-R">df2 &lt;- read_tsv(&quot;data/HOM_MouseHumanSequence.rpt&quot;, col_names=TRUE)

# (キーの名前が２つの表で違う時は以下のように書くとよい)
inner_join(df1, df2, by = c(&quot;mice_gene_symbol&quot;=&quot;Symbol&quot;))

# 上と同じ
df1 %&gt;% 
    inner_join(df2, by = c(&quot;mice_gene_symbol&quot;=&quot;Symbol&quot;))

# join の結果を新たなオブジェクトに格納する
df1 %&gt;% 
    inner_join(df2, by = c(&quot;mice_gene_symbol&quot;=&quot;Symbol&quot;)) -&gt; df1_and_2
</code></pre>
<h2 id="3-tumorcommunicationipynb-を実行する"><a name="3-tumorcommunicationipynb-を実行する" class="plugin-anchor" href="#3-tumorcommunicationipynb-を実行する"><i class="fa fa-link" aria-hidden="true"></i></a>3. <code>tumor_communication.ipynb</code> を実行する</h2>
<h3 id="これはなんなのか？"><a name="これはなんなのか？" class="plugin-anchor" href="#これはなんなのか？"><i class="fa fa-link" aria-hidden="true"></i></a>これはなんなのか？</h3>
<ul>
<li>「非小細胞肺癌 (non-small-cell lung cancer; NSCLC)において、腫瘍組織内に存在する間質細胞から腫瘍細胞にシグナルのクロストークが起こって腫瘍が活性化されるか？ 」を調べてみる解析をRで行うノートブック<ul>
<li><code>.ipynb</code> というのがノートブックの拡張子です</li>
</ul>
</li>
</ul>
<h3 id="データの元論文"><a name="データの元論文" class="plugin-anchor" href="#データの元論文"><i class="fa fa-link" aria-hidden="true"></i></a>データの元論文</h3>
<ul>
<li>Toi et al., Transcriptome Analysis of Individual Stromal Cell Populations Identifies Stroma-Tumor Crosstalk in Mouse Lung Cancer Model, Cell Reports (2015)</li>
<li><a href="https://doi.org/10.1016/j.celrep.2015.01.040" target="_blank">https://doi.org/10.1016/j.celrep.2015.01.040</a></li>
</ul>
<h3 id="サンプル・計測技術について"><a name="サンプル・計測技術について" class="plugin-anchor" href="#サンプル・計測技術について"><i class="fa fa-link" aria-hidden="true"></i></a>サンプル・計測技術について</h3>
<ul>
<li>腫瘍モデルマウス由来のRNA-seqデータ</li>
<li>５種類の組織・細胞群 x 2種類の条件：<ul>
<li>５種類の組織・細胞群細胞群：<ul>
<li>NSCLCモデルマウスと野生型のマウスの肺からセルソーターで分けたもの：マクロファージ、単球細胞、好中球、上皮細胞<ul>
<li>細胞型の分類は細胞表面の抗原マーカーによる<ul>
<li><img src="img/2021-02-07-09-08-20.png" alt width="200"></li>
</ul>
</li>
</ul>
</li>
<li>Total lung cells</li>
</ul>
</li>
<li>2種類の条件: WT （野生型; Wild type)、Tum (腫瘍; Tumor)</li>
</ul>
</li>
</ul>
<h3 id="解析の方針"><a name="解析の方針" class="plugin-anchor" href="#解析の方針"><i class="fa fa-link" aria-hidden="true"></i></a>解析の方針</h3>
<ul>
<li>間質細胞において「正常組織由来のサンプル」に比べて「腫瘍組織由来のサンプル」で発現量が増加している遺伝子群を抽出する</li>
<li>腫瘍組織において正常組織において発現量が増加している遺伝子群を抽出する</li>
<li>「1.に含まれるリガンド」と「2.に含まれる受容体（レセプター）」をリガンド・受容体のペアのデータベースと比較する</li>
</ul>
<h3 id="実行方法"><a name="実行方法" class="plugin-anchor" href="#実行方法"><i class="fa fa-link" aria-hidden="true"></i></a>実行方法</h3>
<p>まず、Jupyter Hub のターミナルで以下のコマンドを実行してください。</p>
<pre><code class="lang-bash">wget https://www.dropbox.com/s/47qm8i5na8rket0/tumor_communication.ipynb
</code></pre>
<p>次に、Juputer Hub で <code>tumor_communication.ipynb</code> を開く。</p>
<h3 id="使うデータの構造"><a name="使うデータの構造" class="plugin-anchor" href="#使うデータの構造"><i class="fa fa-link" aria-hidden="true"></i></a>使うデータの構造</h3>
<ul>
<li><code>gene_exp.diff</code><ul>
<li>マクロファージにおいて、各遺伝子の発現にWTとTumの条件間で差があるかを調べる発現変動解析の結果</li>
<li>列の説明<ul>
<li>test_id: 略</li>
<li>gene_id: 遺伝子ID（ここでは遺伝子名が用いられている）</li>
<li>gene: 略</li>
<li>locus: 略</li>
<li>sample_1: 略</li>
<li>sample_2: 略</li>
<li>status: 略</li>
<li>value_1: 正常組織でのマクロファージにおける遺伝子発現量の平均値</li>
<li>value_2: 腫瘍組織内マクロファージ (intratumoral macropahges)での遺伝子発現量の平均値</li>
<li>log2(fold_change): value_2/value_1をlog2変換したもの。正の値であれば value_2 &gt; value_1、負の値であれば value_1 &gt; value_2</li>
<li>test_stat: 略</li>
<li>p_value: 発現変動を判定する統計検定の結果のp-value。小さい方が統計的に有意。</li>
<li>q_value: p_value を多重検定補正したもの。小さい方が統計的に有意。</li>
<li>significant: 略</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>※ 縦に遺伝子名のようなものが並んでいる。各行が遺伝子、各列が変数になっている
p_valueやq_valueは発現変動を判定する統計検定の結果だろう
log2(fold_change) は value_2/value_1をlog2変換したものだろう
ちなみに、value_1 は正常組織でのマクロファージ、 value_2 は腫瘍組織内マクロファージ (intratumoral macropahges)でのFPKMの平均値
これは メタデータ をみないとわからない</p>
</blockquote>
<ul>
<li><p><code>HOM_MouseHumanSequence.rpt</code></p>
<ul>
<li>ヒト-マウスのオーソログ関係の表。生物種ごとの遺伝子について記述されている。</li>
<li>列の説明<ul>
<li>HomoloGene ID: オーソログ関係自体のID。これが互いに共通なヒト遺伝子・マウス遺伝子はオーソログ関係にある</li>
<li>Common Organism Name: 生物種名</li>
<li>NCBI Taxon ID: 略</li>
<li>Symbol: 遺伝子シンボル</li>
<li>EntrezGene ID</li>
<li>Mouse MGI ID: 略</li>
<li>HGNC ID: 略</li>
<li>OMIM Gene ID: 略</li>
<li>Genetic Location: 略</li>
<li>Genomic Coordinates (mouse: GRCm38, human: GRCh37.p10): 略</li>
<li>Nucleotide RefSeq IDs: 略</li>
<li>Protein RefSeq IDs: 略</li>
<li>SWISS_PROT IDs: 略</li>
</ul>
</li>
</ul>
</li>
<li><p><code>genes.read_group_tracking</code></p>
<ul>
<li>腫瘍細胞において各遺伝子の発現量をまとめた表</li>
<li>列の説明<ul>
<li>tracking_id: 遺伝子のID</li>
<li>condition: 略</li>
<li>replicate: 略</li>
<li>raw_frags: 略</li>
<li>internal_scaled_frags: 略</li>
<li>external_scaled_frags: 略</li>
<li>FPKM: 正規化された遺伝子発現量。大きい方が遺伝子発現量（mRNA量）が多い。</li>
<li>effective_length: 略</li>
<li>status: 略</li>
</ul>
</li>
</ul>
</li>
<li><p><code>LR_manual_revised.txt</code></p>
<ul>
<li>ヒトにおける、リガンドと受容体のペアの対応関係をまとめた表</li>
<li>列の説明<ul>
<li>From: リガンドの遺伝子シンボル</li>
<li>To: 受容体の遺伝子シンボル  </li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><code>GSE59831_processed_data_FPKM.txt</code><ul>
<li>各サンプルでの各遺伝子の発現量を調べた表<ul>
<li>Tum1, Tum2, Tum3 が腫瘍組織内マクロファージ、WT1, WT2が野生型組織でのマクロファージ、Tum9, Tum10, Tum11が腫瘍細胞における遺伝子発現量</li>
</ul>
</li>
<li>列の説明<ul>
<li>mice_gene_symbol: マウスのおける遺伝子シンボル</li>
<li>human_gene_symbol: ヒトのおける遺伝子シンボル</li>
<li>Tum1</li>
<li>Tum2</li>
<li>Tum3</li>
<li>WT1</li>
<li>WT2</li>
<li>Tum4</li>
<li>Tum5</li>
<li>WT3</li>
<li>WT4</li>
<li>Tum6</li>
<li>Tum7</li>
<li>Tum8</li>
<li>WT5</li>
<li>WT6</li>
<li>WT7</li>
<li>Tum9</li>
<li>Tum10</li>
<li>Tum11</li>
<li>WT8</li>
<li>WT9</li>
<li>WT10</li>
<li>Tum12</li>
<li>Tum13</li>
<li>Tum14</li>
<li>WT11</li>
<li>WT12</li>
<li>WT13</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="---"><a name="---" class="plugin-anchor" href="#---"><i class="fa fa-link" aria-hidden="true"></i></a>----</h2>
<h2 id="---"><a name="---" class="plugin-anchor" href="#---"><i class="fa fa-link" aria-hidden="true"></i></a>----</h2>
<h1 id="演習-追記・qaなど"><a name="演習-追記・qaなど" class="plugin-anchor" href="#演習-追記・qaなど"><i class="fa fa-link" aria-hidden="true"></i></a>演習 追記・QAなど</h1>
<!-- ## `.ipynb`ファイルのダウンロード・アップロードする方法
1. GitHub の tumor_communication.ipynb のページまで行きます
    - https://github.com/bioinfo-tsukuba/20210207-EB62104-Bioinformatics/blob/main/%E6%BC%94%E7%BF%92A/tumor_communication.ipynb
2. Raw というボタンを押すと、ファイルの中身が直接ブラウザに表示されます
    - URL例: https://raw.githubusercontent.com/bioinfo-tsukuba/20210207-EB62104-Bioinformatics/main/%E6%BC%94%E7%BF%92A/tumor_communication.ipynb
3. ２通りの方法があります
    - a: 一旦ファイルを自分のコンピューターに保存して、JupyterHubにアップロード
    - b: jupyterHubのターミナルで wget で URL から直接ダウンロード -->
<!-- ### 基本課題A-3 ですが、 outer_join と書いてあるのは full_join の誤りでした

・関数名は `full_join()` でした
・manaba で修正しました https://manaba.tsukuba.ac.jp/ct/course_1318532_rptadmpreview_1855392
・GitHub でも修正しました https://github.com/bioinfo-tsukuba/20210207-EB62104-Bioinformatics/tree/main/%E6%BC%94%E7%BF%92A -->
<!-- ### 基本課題 A-3 は行数のみを提出してください

基本課題 A-3 は行数のみを提出してください（コードは提出しません） -->
<!-- 
### 基本課題A-5 の提出方法を変更します (PDFではなくHTML)

- PDF としていましたが、 HTML (.html) でダウンロードし、manabaで提出してください
- PDF出力がノートブック大きい場合にエラーに出るための措置です -->
<h2 id="4テーブルの読み込みで、headを実行してtsvかcsvか確かめるとありますが、headを実行してもいろいろ文字が出てきてどこを見ればいいかわかりません"><a name="4テーブルの読み込みで、headを実行してtsvかcsvか確かめるとありますが、headを実行してもいろいろ文字が出てきてどこを見ればいいかわかりません" class="plugin-anchor" href="#4テーブルの読み込みで、headを実行してtsvかcsvか確かめるとありますが、headを実行してもいろいろ文字が出てきてどこを見ればいいかわかりません"><i class="fa fa-link" aria-hidden="true"></i></a>4.テーブルの読み込みで、headを実行してTSVかCSVか確かめるとありますが、headを実行してもいろいろ文字が出てきてどこを見ればいいかわかりません…</h2>
<p>簡易的には、</p>
<ul>
<li>コンマで区切られていなければ CSV ではない</li>
<li>一方で、半角スペースではなくタブっぽい間の空き方だったら、TSV</li>
</ul>
<p>あとは例えば、 <code>awk</code> というコマンドを使う方が確実かもしれません</p>
<pre><code class="lang-bash"><span class="hljs-comment"># １行目にタブが含まれていたら１行目が出力される → TSV</span>
$ awk <span class="hljs-string">&apos;NR==1 &amp;&amp; /\t/{print}&apos;</span> data/GSE59831_processed_data_FPKM.txt

<span class="hljs-comment"># １行目にコンマが含まれていたら１行目が出力される → CSV</span>
<span class="hljs-variable">$awk</span> <span class="hljs-string">&apos;NR==1 &amp;&amp; /,/{print}&apos;</span> data/GSE59831_processed_data_FPKM.txt
</code></pre>
<h2 id="isna-の話"><a name="isna-の話" class="plugin-anchor" href="#isna-の話"><i class="fa fa-link" aria-hidden="true"></i></a><code>!is.na()</code> の話</h2>
<ul>
<li>JOIN で NA などの欠損値が出ることがあります</li>
<li>欠損値が邪魔な場合に除くには、まずどれが欠損値かを調べる必要があります</li>
<li><code>is.na()</code> は欠損値であれば TRUE、そうでなければ FALSEを返します</li>
<li><code>!</code> がつくと TRUE/FALSE を逆転させます。<ul>
<li><code>! (WT1&gt;100)</code> は <code>(WT1&lt;=100)</code> と同じ意味です</li>
</ul>
</li>
<li>なので、 <code>!is.na(列名)</code> は ある列の値が欠損値 （NA） <strong>でない</strong> 行ならばTRUE、 NAならばFALSEを返します</li>
</ul>
<pre><code class="lang-R"><span class="hljs-comment"># human が NA でないの行だけにする</span>
fpkm_epi_tumor_human %&lt;&gt;% filter(!<span class="hljs-built_in">is.na</span>(human))

<span class="hljs-comment"># human が NA でないの行だけにする (上と同じ意味)</span>
fpkm_epi_tumor_human %&lt;&gt;% filter(! <span class="hljs-built_in">is.na</span>(human))
</code></pre>
<h2 id="librarymagrittr--の話"><a name="librarymagrittr--の話" class="plugin-anchor" href="#librarymagrittr--の話"><i class="fa fa-link" aria-hidden="true"></i></a><code>library(magrittr)</code>, <code>%&lt;&gt;%</code> の話</h2>
<ul>
<li><code>magrittr</code> パッケージが使える</li>
<li>例えば <code>%&lt;&gt;%</code> が使える。これはパイプの結果を戻して代入すること</li>
</ul>
<pre><code class="lang-R">df1_selected &lt;- select(df1, mice_gene_symbol, WT1)

# 以下の３つは同じ意味
df1_selected %&lt;&gt;% fitler(WT1 &gt; 100)

df1_selected %&lt;&gt;% 
    fitler(WT1 &gt; 100)

df1_selected %&gt;%
    fitler(WT1 &gt; 100) -&gt; df1_selected
</code></pre>
<h2 id="バックスラッシュ----の話"><a name="バックスラッシュ----の話" class="plugin-anchor" href="#バックスラッシュ----の話"><i class="fa fa-link" aria-hidden="true"></i></a>バックスラッシュ ( ` ) の話</h2>
<p>・Rでは文字列を &quot; (ダブルクオート） もしくは &apos; （シングルクオート）で囲みます
・一方、tidyverse では列名を &quot; や &apos; で囲まずに、そのまま書きます
・ところが、列名に半角スペースやカッコが含まれているとうまくいかない。その場合ににはバッククオート（`）で列名を囲むと「そのままの列名」としてRに解釈してもらえる</p>
<pre><code class="lang-R"><span class="hljs-comment"># この例では  log2(fold_change)  をバッククオートで囲んでいる</span>
deg_macrophage %&lt;&gt;% select(gene_id, value_1, value_2, `log2(fold_change)`, p_value, q_value)

<span class="hljs-comment"># 注意：バッククオートを外すとうまくいかなくなる</span>
deg_macrophage %&lt;&gt;% select(gene_id, value_1, value_2, log2(fold_change), p_value, q_value)
</code></pre>
<h2 id="in-について"><a name="in-について" class="plugin-anchor" href="#in-について"><i class="fa fa-link" aria-hidden="true"></i></a><code>%in%</code> について</h2>
<ul>
<li><code>%in%</code> は、あるベクトルの要素が別のベクトルの要素に含まれているかを返す演算子です</li>
<li><code>a %in% b</code> で、aとbがそれぞれベクトルの時、aの各要素が b に含まれるかどうかを（aの長さの分だけ） TRUEもしくはFALSEで返します</li>
</ul>
<pre><code class="lang-R">a &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;Z&quot;</span>) 

b &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;Z&quot;</span>)

<span class="hljs-comment"># a の &quot;A&quot;, &quot;Z&quot; は b に含まれるが、&quot;W&quot; は含まれないので、</span>
<span class="hljs-comment"># 順に TRUE FALSE TRUE が出力される</span>
a %in% b
</code></pre>
<pre><code class="lang-R"><span class="hljs-comment"># `From %in% deg_macrophage_tumor_human$human` は</span>
<span class="hljs-comment"># From の各要素が deg_macrophage_tumor_human$human に含まれるなら TRUE、 </span>
<span class="hljs-comment"># そうでないなら FALSE を返す</span>
dflr %&gt;% 
    mutate(ligand_up_in_tumor_macrophage = From %in% deg_macrophage_tumor_human$human)
</code></pre>
<h2 id="rに組み込みの作図関数について"><a name="rに組み込みの作図関数について" class="plugin-anchor" href="#rに組み込みの作図関数について"><i class="fa fa-link" aria-hidden="true"></i></a>Rに組み込みの作図関数について</h2>
<h3 id="ヒストグラムを描く-hist"><a name="ヒストグラムを描く-hist" class="plugin-anchor" href="#ヒストグラムを描く-hist"><i class="fa fa-link" aria-hidden="true"></i></a>ヒストグラムを描く <code>hist()</code></h3>
<ul>
<li><code>hist()</code> は第一引数で数値の列を与えると、そのヒストグラムを描きます</li>
</ul>
<h2 id="プロットを描く-plot"><a name="プロットを描く-plot" class="plugin-anchor" href="#プロットを描く-plot"><i class="fa fa-link" aria-hidden="true"></i></a>プロットを描く <code>plot()</code></h2>
<ul>
<li><code>plot()</code> は様々なプロットを描ける関数です</li>
<li>例えば、 <code>plot(x, y)</code> と x と y が同じ長さの数値列の場合、散布図を描くことができます</li>
</ul>
<h3 id="filter-でコンマ（）で繋ぐのは"><a name="filter-でコンマ（）で繋ぐのは" class="plugin-anchor" href="#filter-でコンマ（）で繋ぐのは"><i class="fa fa-link" aria-hidden="true"></i></a><code>filter()</code> でコンマ（<code>,</code>）で繋ぐのは</h3>
<pre><code class="lang-R"><span class="hljs-comment"># 以下の２つは同じ意味です</span>
s
filter(`log2(fold_change)` &gt; log2(<span class="hljs-number">1.5</span>), q_value &lt; <span class="hljs-number">0.1</span>)
</code></pre>
</body></html>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="B_00.md" class="navigation navigation-prev " aria-label="Previous page: イントロ">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="B_02.html" class="navigation navigation-next " aria-label="Next page: 課題">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"手順","level":"1.3.2","depth":2,"next":{"title":"課題","level":"1.3.3","depth":2,"path":"Training_B/B_02.md","ref":"Training_B/B_02.md","articles":[]},"previous":{"title":"イントロ","level":"1.3.1","depth":2,"path":"Training_B/B_00.md","ref":"Training_B/B_00.md","articles":[]},"dir":"ltr"},"config":{"plugins":["anchors","advanced-emoji","hide-published-with","copy-code-button","intopic-toc","back-to-top-button","multipart","embed-pdf"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"intopic-toc":{"selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4, .markdown-section h5, .markdown-section h6","mode":"nested","maxDepth":6,"isCollapsed":true,"isScrollspyActive":true,"visible":true,"label":"In this article"},"search":{},"multipart":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-published-with":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"back-to-top-button":{},"copy-code-button":{},"advanced-emoji":{"embedEmojis":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"embed-pdf":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"タイトル","language":"ja","gitbook":"*","description":"詳細説明"},"file":{"path":"Training_B/B_01.md","mtime":"2023-01-21T09:53:22.292Z","type":"markdown"},"gitbook":{"version":"4.0.4","time":"2023-01-21T11:13:36.889Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-hide-published-with/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/gumshoe.polyfills.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-intopic-toc/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

